INFO: localdir at /scratch/91006.gcrepaldi
INFO: your job will run on local system.
Using GPU: cuda:0
Using num thread = 2
n_hotels is 92091
n_features_w2vec is 100
n_features_meta is 0
n_features_impression is 16
n_features is 116
The model is:
input_dim is:116
hidden_dim is: 200
output_dim is:92091
6382 sessions to be computed
Epoch: 1 Loss: 11.92347358469304
1 5% (18m 54s)
Traceback (most recent call last):
  File "setup.py", line 301, in <module>
    acc = tst.test_accuracy_optimized(model, df_test, df_gt, test_sessions, test_hotels_window, test_clickout_index, hotel_dict, n_features, max_window, meta_dict, meta_list)
  File "/home/gcrepaldi/touringrec/SetupScript/RNN/test_f.py", line 258, in test_accuracy_optimized
    df_test.loc[clickout_index[session_index], 'item_recommendations'] = evaluate(model, session, hotel_dict, n_features, hotels_window[session_index], max_window, meta_dict, meta_list)
  File "/home/gcrepaldi/touringrec/SetupScript/RNN/test_f.py", line 44, in evaluate
    session_tensor = lstm.session_to_tensor(session, hotel_dict, n_features, hotels_window, max_window, meta_dict, meta_list)
  File "/home/gcrepaldi/touringrec/SetupScript/RNN/LSTM.py", line 84, in session_to_tensor
    tensor[ai][0] = hotel_to_tensor(action['reference'], hotel_dict, n_features, hotels_window, max_window, meta_dict, meta_list)
  File "/home/gcrepaldi/touringrec/SetupScript/RNN/LSTM.py", line 116, in hotel_to_tensor
    tensor_window[hotels_window.index(hotel)] = 1
IndexError: index 21 is out of bounds for dimension 0 with size 16
